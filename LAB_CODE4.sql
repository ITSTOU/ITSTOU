CREATE DATABASE LABBOY4;

-- 4.1 CREATE TABLE 
-- 4.1.1 ROOM TABLE
CREATE TABLE ROOM(
	RM_ID CHAR(4) NOT NULL PRIMARY KEY,
	RM_NAME CHAR(30) NOT NULL,
	RM_LOC CHAR(5) NOT NULL,
	RM_CAP INT NOT NULL
);
-- 4.1.2 SOFTWARE TABLE
CREATE TABLE SOFTWARE(
	SW_ID CHAR(4) NOT NULL PRIMARY KEY,
	SW_NAME CHAR(25) NOT NULL,
	SW_VER CHAR(5) NOT NULL
);
-- 4.1.3 INSTALLATION TABLE 
CREATE TABLE INSTALLATION(
	RM_ID CHAR(4) NOT NULL REFERENCES ROOM(RM_ID),
	SW_ID CHAR(4) NOT NULL REFERENCES SOFTWARE(SW_ID),
	DATE_INS DATETIME NOT NULL,
	PRIMARY KEY(RM_ID, SW_ID)
);
-- 4.1.4 USER TABLE
CREATE TABLE USERS(
	U_ID CHAR(8) NOT NULL PRIMARY KEY,
	U_NAME CHAR(30) NOT NULL,
	U_TYPE CHAR(1) NOT NULL
);
-- 4.1.5 LABBOY TABLE
CREATE TABLE LABBOY(
	LB_ID CHAR(4) NOT NULL PRIMARY KEY,
	LB_NAME CHAR(30) NOT NULL,
	LB_TYPE CHAR(1) NOT NULL,
	LB_PHONE CHAR(12) NOT NULL,
	LB_EXP_YR INT NOT NULL
);
-- 4.1.6 RESERVATION TABLE
CREATE TABLE RESERVATION(
	RV_DATE DATETIME NOT NULL,
	RV_NUM INT NOT NULL,
	USE_DATE DATETIME NOT NULL,
	USE_TIN DATETIME NOT NULL,
	USE_TOUT DATETIME NOT NULL,
	RM_ID CHAR(4) NOT NULL REFERENCES ROOM(RM_ID),
	U_ID CHAR(8) NOT NULL REFERENCES USERS(U_ID),
	LB_ID CHAR(4) NOT NULL REFERENCES LABBOY(LB_ID),
	PRIMARY KEY (RV_DATE, RV_NUM)
);
-- 4.1.7 PERIOD TABLE
CREATE TABLE PERIOD(
	G_ID CHAR(1) NOT NULL PRIMARY KEY,
	W_TIN DATETIME NOT NULL,
	W_TOUT DATETIME NOT NULL
);
-- 4.1.8 OPERATION TABLE
CREATE TABLE OPERATION(
	OP_DATE DATETIME NOT NULL,
	OP_NUM INT NOT NULL,
	LB_ID CHAR(4) NOT NULL REFERENCES LABBOY(LB_ID),
	G_ID CHAR(1) NOT NULL REFERENCES PERIOD(G_ID),
	RM_ID CHAR(4) NOT NULL REFERENCES ROOM(RM_ID),
	PRIMARY KEY(OP_DATE, OP_NUM)
);

-- END 

-- 4.2 UPDATE TABLE
-- 4.2.1 ADD U_PHONE
ALTER TABLE USERS
ADD U_PHONE CHAR(7);

-- 4.2.2 CHANGE U_PHONE DATA TYPE
ALTER TABLE USERS
ALTER COLUMN U_PHONE CHAR(12);

-- 4.2.3 RENAME U_PHONE TO USERS_PHONE
SP_RENAME 'USERS.U_PHONE','USERS_PHONE'

-- 4.2.3 DROP USERS_PHONE
ALTER TABLE USERS
DROP COLUMN USERS_PHONE;

-- END

-- 4.3 ADD DATA

INSERT INTO ROOM
VALUES ('RM01','Com1','FL01','30');
INSERT INTO ROOM
VALUES ('RM02','Com2','FL01','30');
INSERT INTO ROOM
VALUES ('RM03','Com3','FL02','20');
INSERT INTO ROOM
VALUES ('RM04','Admin1','FL02','10');
INSERT INTO ROOM
VALUES ('RM05','Admin2','FL03','10');


INSERT INTO SOFTWARE
VALUES ('Sw01','Microsoft Windows','10');
INSERT INTO SOFTWARE
VALUES ('Sw02','Microsoft Office','2015');
INSERT INTO SOFTWARE
VALUES ('Sw03','Microsoft SQL','2005');
INSERT INTO SOFTWARE
VALUES ('Sw04','Microsoft Windows','98');
INSERT INTO SOFTWARE
VALUES ('Sw05','Microsoft SQL','2016');


INSERT INTO INSTALLATION
VALUES ('RM01','Sw01','5/22/2009');
INSERT INTO INSTALLATION
VALUES ('RM02','Sw02','4/22/2015');
INSERT INTO INSTALLATION
VALUES ('RM03','Sw03','2/22/2017');
INSERT INTO INSTALLATION
VALUES ('RM04','Sw04','12/22/2010');
INSERT INTO INSTALLATION
VALUES ('RM05','Sw05','7/22/2014');


INSERT INTO USERS
VALUES ('U01','John','F');
INSERT INTO USERS
VALUES ('U02','Jane','S');
INSERT INTO USERS
VALUES ('U03','Adam','U');
INSERT INTO USERS
VALUES ('U04','Max','U');
INSERT INTO USERS
VALUES ('U05','Boy','S');


INSERT INTO LABBOY
VALUES ('LB01','Pater','1','08907238564','2');
INSERT INTO LABBOY
VALUES ('LB02','Lee','1','08842727565','3');
INSERT INTO LABBOY
VALUES ('LB03','Anderson','2','08743142000','9');
INSERT INTO LABBOY
VALUES ('LB04','Sara','3','0862149572','9');
INSERT INTO LABBOY
VALUES ('LB05','Jame','3','08842472625','10');


INSERT INTO RESERVATION
VALUES ('2/22/2014','01','6/22/2012','4:21:40','1:08:22','RM01','U01','LB01');
INSERT INTO RESERVATION
VALUES ('7/22/2014','01','10/22/2016','7:29:10','11:27:43','RM02','U02','LB02');
INSERT INTO RESERVATION
VALUES ('1/22/2011','01','2/22/2016','6:49:25','2:40:47','RM03','U03','LB03');
INSERT INTO RESERVATION
VALUES ('7/22/2009','01','12/22/2015','12:23:57','12:56:58','RM04','U04','LB04');
INSERT INTO RESERVATION
VALUES ('7/22/2012','01','10/22/2013','10:52:45','4:22:55','RM05','U05','LB05');


INSERT INTO PERIOD
VALUES ('A','8:00','12:00');
INSERT INTO PERIOD
VALUES ('B','12:00','13:00');
INSERT INTO PERIOD
VALUES ('C','13:00','17:00');
INSERT INTO PERIOD
VALUES ('D','17:00','20:00');


INSERT INTO OPERATION
VALUES ('4/22/2014','1','LB03','B','RM02');
INSERT INTO OPERATION
VALUES ('5/22/2016','2','LB02','B','RM04');
INSERT INTO OPERATION
VALUES ('5/22/2016','3','LB02','C','RM04');
INSERT INTO OPERATION
VALUES ('8/22/2009','4','LB04','D','RM05');
INSERT INTO OPERATION
VALUES ('3/22/2013','5','LB03','D','RM05');

-- END

-- 4.4 DROP ROOM

DROP TABLE INSTALLATION;
DROP TABLE RESERVATION;
DROP TABLE OPERATION;

DROP TABLE ROOM;

-- END
